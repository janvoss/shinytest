[{"name":"app.R","content":"library(shiny)\r\nlibrary(ggplot2)\r\n\r\nui <- fluidPage(\r\n  titlePanel(\"Interaktive Budgetrestriktion und Indifferenzkurve\"),\r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      sliderInput(\"I\", \"Einkommen (I):\", min = 10, max = 300, value = 100, step = 1),\r\n      sliderInput(\"p1\", \"Preis von Gut 1 (p1):\", min = 0.1, max = 5, value = 1, step = 0.1),\r\n      sliderInput(\"p2\", \"Preis von Gut 2 (p2):\", min = 0.1, max = 5, value = 0.5, step = 0.1),\r\n      sliderInput(\"alpha\", \"Gewichtungsparameter (alpha):\", min = 0, max = 1, value = 0.3, step = 0.01)\r\n    ),\r\n    mainPanel(\r\n      plotOutput(\"mainplot\", height = \"500px\")\r\n    )\r\n  )\r\n)\r\n\r\nserver <- function(input, output, session) {\r\n  output$mainplot <- renderPlot({\r\n    # Parameter\r\n    I <- input$I\r\n    p1 <- input$p1\r\n    p2 <- input$p2\r\n    alpha <- input$alpha\r\n    \r\n    x1_eq <- alpha * I / p1\r\n    x2_eq <- (1 - alpha) * I / p2\r\n    U_eq <- x1_eq^alpha * x2_eq^(1 - alpha)\r\n    x1 <- 0:100\r\n    \r\n    df <- rbind(\r\n      data.frame(x1, Kurve = \"Budget\", x2 = I / p2 - p1 / p2 * x1),\r\n      data.frame(x1, Kurve = \"Indifferenz\", x2 = (U_eq / (x1^alpha))^(1 / (1 - alpha)))\r\n    )\r\n    \r\n    # Filter unendliche/nicht-numerische x2 (z.B. durch Division durch 0) heraus\r\n    df <- df[is.finite(df$x2) & df$x2 >= 0, ]\r\n    \r\n    ggplot(df, aes(x1, x2, color = Kurve)) +\r\n      geom_line(linewidth = 1) +\r\n      annotate(\"point\", x = x1_eq, y = x2_eq, color = \"black\", size = 2) +\r\n      annotate(\"segment\", x = x1_eq, xend = x1_eq, y = 0, yend = x2_eq, linetype = \"dashed\", color = \"black\") +\r\n      annotate(\"segment\", x = 0, xend = x1_eq, y = x2_eq, yend = x2_eq, linetype = \"dashed\", color = \"black\") +\r\n      scale_x_continuous(\r\n        limits = c(NA, I / p1 + 10), expand = c(0, 0),\r\n        breaks = round(c(0, .5 * I / p1, I / p1, x1_eq), 2)\r\n      ) +\r\n      scale_y_continuous(\r\n        limits = c(NA, I / p2 + 10), expand = c(0, 0),\r\n        breaks = round(c(0, .5 * I / p2, I / p2, x2_eq), 2)\r\n      ) +\r\n      theme_light(base_size = 15) +\r\n      labs(\r\n        title = \"Die Budgetbeschr√§nkung und Indifferenzkurve\",\r\n        x = expression(x[1]),\r\n        y = expression(x[2])\r\n      )\r\n  })\r\n}\r\n\r\nshinyApp(ui, server)\r\n","type":"text"}]
